(function(_ds){var window=this;var pO=function(a){var b=a.Hf,c=a.Tb,d=a.credentials,e=a.ld,f=a.md,g=a.Tf,h=a.Vf,k=a.ud,l=a.projectId,m=a.Cd,n=a.Pg,q=a.Qg,r=a.Jd,w=a.ah,z=a.mc;return(0,_ds.T)('<devsite-dialog class="devsite-credentials-dialog" id="'+_ds.V(a.Uf)+'"><div class="devsite-dialog-contents">'+nO(c,d,e,f,h,k,l,m,n,q,r,w,z)+'</div><div class="devsite-dialog-buttons">'+oO(b,c,g,l,z)+"</div></devsite-dialog>")},qO=function(a){return nO(a.Tb,a.credentials,a.ld,a.md,a.Vf,a.ud,a.projectId,a.Cd,a.Pg,a.Qg,a.Jd,a.ah,a.mc)},nO=function(a,
b,c,d,e,f,g,h,k,l,m,n,q){var r=_ds.T;e="<h3>"+_ds.U(e)+"</h3>";if(q){n="";if(l)n+="<div>Loading projects...</div><devsite-spinner></devsite-spinner>";else if(k)n+='Sorry. We couldn\'t load your projects. You can visit <a href="https://console.developers.google.com">Developers Console</a> to see them.';else if(0<h.length){n+='<label>Project</label><select class="devsite-credentials-dialog-selector">';k=h.length;for(l=0;l<k;l++)q=h[l],n+='<option value="'+_ds.V(q.id)+'"'+(g==q.id?" selected":"")+">"+
_ds.U(q.title)+"</option>";n+="</select>"}else n+='You have no projects. You can create one in the <a href="https://console.developers.google.com">Developers Console</a>.';a='<div class="devsite-credentials-dialog-projects">'+(0,_ds.T)(n)+'</div><div class="devsite-credentials-dialog-credentials">'+rO(a,b,c,d,f,g)+'</div><div class="devsite-credentials-dialog-oauth-message">'+sO(a,g,m)+"</div>"}else a='<p class="devsite-credentials-dialog-signin-message">',b='Sign in to <a href="'+(_ds.V(_ds.X(n))+
'">insert your credentials.</a>'),a=a+b+"</p>",a=(0,_ds.T)(a);return r(e+a)},tO=function(a){return oO(a.Hf,a.Tb,a.Tf,a.projectId,a.mc)},oO=function(a,b,c,d,e){let f="";b="https://console.developers.google.com/apis/credentials/"+_ds.uC(b)+"?project="+_ds.tC(d);b=(0,_ds.bC)(b);f+='<button class="devsite-dialog-close" type="button">Cancel</button>';e&&("oauth"==c&&(f+='<a class="button devsite-credentials-dialog-view devsite-credentials-dialog-action '+(a?"":"button-disabled")+'" type="button" href="'+
_ds.V(_ds.X(b))+'" target="_blank">',f+="View</a>"),"api_key"==c&&(f+='<button class="devsite-credentials-dialog-insert devsite-credentials-dialog-action" type="button"'+(a?"":" disabled")+">Insert</button>"));return(0,_ds.T)(f)},uO=function(a){return rO(a.Tb,a.credentials,a.ld,a.md,a.ud,a.projectId)},rO=function(a,b,c,d,e,f){let g="";f="https://console.developers.google.com/apis/credentials?project="+_ds.tC(f);f=(0,_ds.bC)(f);if(e)if(d)g+="<div>Loading credentials...</div><devsite-spinner></devsite-spinner>";
else if(c)g+='Sorry. We couldn\'t load the credentials for this project. You can visit the <a href="https://console.developers.google.com">Developers Console</a> to see them.';else if(0<b.length){g+='<label>Credentials</label><select class="devsite-credentials-dialog-selector">';c=b.length;for(d=0;d<c;d++)e=b[d],g+='<option value="'+_ds.V(e.credential)+'"'+(a==e.credential?" selected":"")+">"+_ds.U(e.type)+": "+_ds.U(e.credential)+"</option>";g+="</select>"}else a='This project has no appropriate credentials. You can add one in the <a href="'+
(_ds.V(_ds.X(f))+'">Developers Console</a>.'),g+=a;return(0,_ds.T)(g)},vO=function(a){return sO(a.Tb,a.projectId,a.Jd)},sO=function(a,b,c){let d="";a="https://console.developers.google.com/apis/credentials/"+_ds.uC(a)+"?project="+_ds.tC(b);a=(0,_ds.bC)(a);c&&(c='<b>Note:</b> For security, this credential can only be displayed in the <a href="'+(_ds.V(_ds.X(a))+'">Google API Console</a>. You can copy and paste it from there.'),d+=c);return(0,_ds.T)(d)};var BO=async function(a){try{await DevsiteApp.whenReady()}catch(d){a.remove();return}if(a.isConnected){if(!a.W){var b=a.querySelector(".replaceable-credential");b&&(b.hasAttribute("data-devsite-credential-type")&&a.setAttribute("type",b.getAttribute("data-devsite-credential-type")),a.className=b.className,a.classList.remove("replaceable-credential"),a.innerText=b.innerText);if(!a.hasAttribute("type"))return;wO(a);a.j=a.getAttribute("type");"api_key"===a.j?(a.L="api-key-credentials-dialog",a.setAttribute("data-modal-dialog-id",
"api-key-credentials-dialog"),a.setAttribute("data-title","Click to insert your API key"),a.R="Insert API key"):"oauth"===a.j&&(a.L="oauth-credentials-dialog",a.setAttribute("data-modal-dialog-id","oauth-credentials-dialog"),a.setAttribute("data-title","Click to view your OAuth client credentials"),a.R="View OAuth client credentials");a.setAttribute("projects-loading","");a.setAttribute("credentials-loading","");a.W=!0}if("api_key"===a.j||"oauth"===a.j){b=_ds.P(pO,{Hf:a.J,Tb:a.D,credentials:a.v,ld:a.hasAttribute("credentials-error"),
md:a.hasAttribute("credentials-loading"),Tf:a.j,Uf:a.L,Vf:a.R,ud:a.G,projectId:a.C,Cd:a.F,Pg:a.hasAttribute("projects-error"),Qg:a.hasAttribute("projects-loading"),Jd:a.O,ah:a.T,mc:a.K});var c=document.body.querySelector(`#${a.L}`);c?a.h=c:(document.body.appendChild(b),a.h=b);xO(a);yO(a);zO(a)}AO(a)}},AO=function(a){a.H.listen(document.body,"devsite-dialog-show",()=>{CO(a,"Credentials Dialog Shown")});a.H.listen(a,"click",()=>{DO(a)})},CO=function(a,b){a.dispatchEvent(new CustomEvent("devsite-analytics-observation",
{detail:{category:"Credentials Dialog",action:b},bubbles:!0}))},DO=async function(a){wO(a);await EO(a);await FO(a);a.h&&(_ds.M(a.h.querySelector(".devsite-dialog-contents"),qO,{Tb:a.D,credentials:a.v,ld:a.hasAttribute("credentials-error"),md:a.hasAttribute("credentials-loading"),Vf:a.R,ud:a.G,projectId:a.C,Cd:a.F,Pg:a.hasAttribute("projects-error"),Qg:a.hasAttribute("projects-loading"),Jd:a.O,ah:a.T,mc:a.K}),xO(a),yO(a));GO(a)},JO=async function(a){if(a.h){var b=a.h.querySelector(".devsite-credentials-dialog-projects .devsite-credentials-dialog-selector");
b instanceof HTMLSelectElement&&(b=a.F[b.selectedIndex])&&(a.C=b.id,a.M=b.number,await FO(a),HO(a),IO(a),GO(a))}},xO=function(a){const b=a.h.querySelector(".devsite-credentials-dialog-projects .devsite-credentials-dialog-selector");b instanceof HTMLSelectElement&&a.H.listen(b,"change",()=>{JO(a)})},yO=function(a){const b=a.h.querySelector(".devsite-credentials-dialog-credentials .devsite-credentials-dialog-selector");b instanceof HTMLSelectElement&&a.H.listen(b,"change",()=>{if(a.h){var c=a.h.querySelector(".devsite-credentials-dialog-credentials .devsite-credentials-dialog-selector");
c instanceof HTMLSelectElement&&(a.D=a.v[c.selectedIndex].credential,HO(a),IO(a),GO(a))}})},zO=function(a){var b=a.h.querySelector(".devsite-credentials-dialog-insert");b&&a.H.listen(b,"click",()=>{a.innerText=a.D;a.h.open=!1;CO(a,"Credentials Dialog Successful Insert")});(b=a.h.querySelector(".devsite-credentials-dialog-view"))&&a.H.listen(b,"click",()=>{CO(a,"Credentials Dialog Successful View")})},wO=function(a){const b=document.querySelector("devsite-user");b&&(a.K=b.hasAttribute("signed-in"));
b&&b.hasAttribute("sign-in-url")&&(a.T=b.getAttribute("sign-in-url"))},EO=async function(a){if(a.K){a.setAttribute("projects-loading","");a.removeAttribute("projects-error");a.G=!1;try{const b=await _ds.aj("/profile/projects",null,"GET",!0),c=_ds.ye(_ds.yH,b);a.F=KO(c);0<a.F.length&&(a.C=a.F[0].id,a.M=a.F[0].number,a.G=!0)}catch(b){a.setAttribute("projects-error",""),a.F=[],CO(a,"Credentials Dialog Projects Error")}finally{a.removeAttribute("projects-loading")}}},FO=async function(a){if(a.K&&a.M&&
a.C){a.setAttribute("credentials-loading","");a.removeAttribute("credentials-error");try{var b="";"api_key"==a.j&&(b=await _ds.aj("/profile/api_keys",JSON.stringify({project_id:a.C})));"oauth"==a.j&&(b=await _ds.aj("/profile/oauth_clients",JSON.stringify({project_number:a.M})));a.v=LO(b)}catch(c){a.setAttribute("credentials-error",""),a.v=[],CO(a,"Credentials Dialog Credentials Error")}finally{a.removeAttribute("credentials-loading")}0<a.v.length&&(a.D=a.v[0].credential);b=!a.hasAttribute("credentials-loading")&&
!a.hasAttribute("credentials-error")&&0<a.v.length;a.J=a.G&&b;a.O="oauth"==a.j&&a.J}},GO=function(a){a.h&&(_ds.M(a.h.querySelector(".devsite-dialog-buttons"),tO,{Hf:a.J,Tf:a.j,projectId:a.C,mc:a.K,Tb:a.D}),zO(a))},KO=function(a){return _ds.Cb(a,_ds.wH,1).sort((b,c)=>_ds.x(b,2).localeCompare(_ds.x(c,2))).map(b=>({id:_ds.x(b,2),number:_ds.Ae(b,3).toString(),title:b.getTitle()}))},LO=function(a){a=JSON.parse(a);return Object.entries(a).sort((b,c)=>b[0].localeCompare(c[0])).map(b=>({credential:b[0],type:b[1].type}))},
HO=function(a){a.h&&(_ds.M(a.h.querySelector(".devsite-credentials-dialog-credentials"),uO,{Tb:a.D,credentials:a.v,ld:a.hasAttribute("credentials-error"),md:a.hasAttribute("credentials-loading"),projectId:a.C,ud:a.G}),yO(a))},IO=function(a){a.h&&_ds.M(a.h.querySelector(".devsite-credentials-dialog-oauth-message"),vO,{Jd:a.O,Tb:a.D,projectId:a.C})},MO=class extends _ds.D{constructor(){super();this.H=new _ds.F;this.J=this.W=!1;this.j=this.D="";this.v=[];this.h=null;this.R=this.L="";this.G=!1;this.M=
this.C="";this.F=[];this.O=!1;this.T="";this.K=!1;this.ea=new _ds.pk(()=>BO(this),250)}connectedCallback(){this.ea.xa()}disconnectedCallback(){_ds.G(this.H);var a=!document.querySelector(`devsite-credentials-dialog[type="${this.j}"]`);this.hasAttribute("data-modal-dialog-id")&&a&&(a=document.body.querySelector(`#${this.getAttribute("data-modal-dialog-id")}`))&&document.body.removeChild(a)}};MO.prototype.disconnectedCallback=MO.prototype.disconnectedCallback;MO.prototype.connectedCallback=MO.prototype.connectedCallback;try{window.customElements.define("devsite-credentials-dialog",MO)}catch(a){console.warn("devsite.app.customElement.DevsiteCredentialsDialog",a)};})(_ds_www);
